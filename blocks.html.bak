<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>Noso Exporer</title>
    <script src="https://cdn.amcharts.com/lib/5/index.js"></script>
    <script src="https://cdn.amcharts.com/lib/5/map.js"></script>
    <script src="https://cdn.amcharts.com/lib/5/geodata/worldLow.js"></script>
    <script src="https://cdn.amcharts.com/lib/5/themes/Animated.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.min.js"
integrity="sha512-d9xgZrVZpmmQlfonhQUvTR7lMPtO7NkZMkA0ABN3PHCbKA5nqylQ/yWlFAyY6hYgdF1Qh6nYiuADWwKB4C2WSw=="
crossorigin="anonymous">
</script><!---chart-->
    <script src="js/chartpopw.js"></script>
    <script src="js/chartnodes.js"></script>
   <script type="text/javascript" src="main.js"></script>







    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.css" rel="stylesheet">
    <!-- Add custom CSS here -->
    <link href="css/sb-admin.css" rel="stylesheet">
    <link rel="stylesheet" href="font-awesome/css/font-awesome.min.css">
    <!-- Page Specific CSS -->
    <link rel="stylesheet" href="http://cdn.oesmith.co.uk/morris-0.4.3.min.css">
    <!--style-->
  </head>
  <body color="#222222" style="         background-image: url(&quot;&quot;);">
    <div id="wrapper">
      <!-- Sidebar -->
      <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header"> <button type="button" class="navbar-toggle"
            data-toggle="collapse" data-target=".navbar-ex1-collapse"> <span class="sr-only">Toggle
              navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span>
            <span class="icon-bar"></span> </button><a class="navbar-brand" href="index.html"><img
              src="img/logo_clearbg.png" alt="nosologo" title="nosologo" style="width: 20px; height: 20px;">
            Noso</a> </div>
        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse navbar-ex1-collapse">
          <ul class="nav navbar-nav side-nav">
            <li class="active"><a href="index.html"><i class="fa fa-dashboard"></i>
                Overview</a></li>
            <li><a href="blocks.html">&nbsp;Blocks</a></li>
            <li><a href="coins.html"> Coin Distribution</a></li>
            <li><a href="addresses.html"> Top Addresses</a></li>
            <li><a href="masternodes.html">Masternodes</a></li>
            <li><a href="earning.html"> Earning</a></li>
            <li><a href="statistics.html">Statistic</a></li>
            <li><a href="markets.html">&nbsp;Markets</a></li>
            <li class="dropdown"> <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i
                  class="fa fa-caret-square-o-down"></i> About <b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><a href="#">Dropdown Item</a></li>
                <li><a href="#">Another Item</a></li>
                <li><a href="#">Third Item</a></li>
                <li><a href="#">Last Item</a></li>
              </ul>
            </li>
          </ul>
        <!-- /.navbar-collapse --> </nav>
      <div id="page-wrapper">
        <div class="row">
          <div class="col-lg-12">
            <h1>Noso <small>Block Explorer</small></h1>
          </div>
        </div>
        <!-- /.row --> </div>
      </div>
      <div class="header">
            
            <div class="headerElement">
                <div id="chartLabel"></div>
                <div id ='ss'>
                  <canvas id="networkStats"></canvas>
                </div>
            </div>
            <div class="headerElement">
                <div id="chartLabel">Mn's</div>
                <div id ='ss'>
                  <canvas id="blockTime"></canvas>
                </div>
            </div>
            <div class="headerElement">
                <div  id="chartLabel">Orders per Block</div>
                  <div id ='ss'>
                <canvas id="mini"></canvas>
              </div>
            </div>
            <div class="headerElement">
                <div id="chartLabel">Amounts per block</div>
                  <div id ='ss'>
                <canvas id="mid"></canvas>
              </div>
            </div>
            <div class="headerElement">
                <div id="chartLabel">Pending Orders</div>
                <div id="big"></div>
            </div>
            </div>
        <div class="mainPart">
            <div class="menu">
                <div id='newCounter'></div>
    
                <div id ='menuCharts'>
                  <canvas id="distributionCanvas"></canvas>
                </div>
                <div id ='menuCharts'>
                  <canvas id="clientCanvas"></canvas>
                </div>
                <div id ='menuCharts'>
                  <canvas id="solCanvas"></canvas>
                  </div>
                </div>
              <div class="result">
                <div id='explorerBox'>
                  <input id = 'searchBox'  name="blockNumber" placeholder="Search for Block ...">
                </div>
                <div class="halfVerical">
                  <div id="blockChart"></div>
                </div>
                <div class="halfVerical">
                  <div id="feesChart"></div>
                </div>
              

                <div class="halfVerical">
                  <div id="mnsChart"></div>
                </div>
                <div class="halfVerical">
                  <div id="posChart"></div>
                </div>
              </div>

            </div>
        <script>
            console.log('state :' , sessionStorage.state)
            if (window.menuState === 'explorer1'){
                document.getElementById("explorer1").style.backgroundColor = "RGBA(96, 125, 139)";
                sessionStorage.setItem("state", 'explorer1')
                //refreshExplorer1()
              }
              else {
                //pendingOrders()
              async function firstPass(){
                let response2 = await fetch(sessionStorage.apiServer + 'dBheight');
                let  dbHeight= await response2.json();
                console.log('height' , dbHeight)
                block = sessionStorage.getItem('searchedBlock');
                state = sessionStorage.getItem('state');
                document.getElementById('searchBox').value = block;
                refreshExplorer1 (block)
                console.log( 'out of fun' , window.blockData)
                renderHTML();
                }
                firstPass()
              //document.getElementById("explorer1").style.backgroundColor = "RGBA(207,207,0,0.56)";
              sessionStorage.setItem("state", 'explorer1');
              var el = document.getElementById("searchBox");
              var target = document.getElementById('searchBox').value
              el.addEventListener("keydown", function(event) {
                  if (event.key === "Enter") {
                    console.log( document.getElementById('searchBox').value)
                    refreshExplorer1( document.getElementById('searchBox').value)
                  }
                });
              block = sessionStorage.getItem('searchedBlock');
              state = sessionStorage.getItem('state');
              document.getElementById('searchBox').value = block;
              document.getElementById("explorer1").style.backgroundColor = "RGBA(96, 125, 139)";
              window.menuState = 'explorer1' ;
              //refreshExplorer1() ;
              }
              //------------------------------------------------------------------------------------
            async function refreshExplorer1(target){
              console.log('state inside refresh :' , window.menuState)
              document.getElementById("explorer1").style.backgroundColor = "RGBA(96, 125, 139)";
              let response = await fetch(sessionStorage.apiServer + 'chartBlock/'+target);
              let data = await response.json();
              let blockData = data[0]
              let mnsData  = data[1]
              let posData = data[2]
              let feeData = data[3]
              //sessionStorage.setItem("blockData", blockData);
              console.log('blockData' , blockData)
              window.chartblock = target
              window.blockFlag = 'True'
              window.feeFlag = 'True'
              window.mnsFlag = 'True'
              window.posFlag = 'True'
              window.blockData = blockData
              window.mnsData = mnsData
              window.posData = posData
              window.feeData = feeData
              

              };
              //------------------------------------------------------------------------------------------
            function renderHTML() {
              
    
                am5.ready(function() {
                    var root = am5.Root.new("blockChart");
                    root.setThemes([
                      am5themes_Animated.new(root)
                    ]);
                    var series = root.container.children.push(am5flow.ChordDirected.new(root, {
                      startAngle: 40,
                      padAngle: 2,
                      linkHeadRadius: undefined,
                      sourceIdField: "from",
                      targetIdField: "to",
                      valueField: "value"
                    }));
                    series.nodes.labels.template.setAll({
                      textType: "radial",
                      centerX: 0,
                      fontSize: 10
                    });
                    series.links.template.set("fillStyle", "source");
                    setInterval(function() {
                       updateData();
                      }, 2000)
                    async function updateData() {
                        blockFlag = window.blockFlag
                        if (blockFlag==='True'){
                          series.hide(1000).then(function(ev) {
                              console.log("Series finished hiding");
                              data = window.blockData
                              series.data.setAll(data);
                              series.appear(1000, 100);
                              window.blockFlag = 'False'
                            })
                        }
                      }
                    series.appear(100, 100);
                  }); 
                  //---------------------------------------------------------------------------------
                
                am5.ready(function() {
                    var root = am5.Root.new("feesChart");
                    root.setThemes([
                      am5themes_Animated.new(root)
                    ]);
                    var series = root.container.children.push(am5flow.ChordDirected.new(root, {
                      startAngle: 40,
                      padAngle: 4,
                      linkHeadRadius: undefined,
                      sourceIdField: "from",
                      targetIdField: "to",
                      valueField: "value"
                    }));
                    series.nodes.labels.template.setAll({
                      textType: "radial",
                      centerX: 0,
                      fontSize: 10
                    });
                    series.links.template.set("fillStyle", "source");
                    setInterval(function() {
                       updateData();
                      }, 2000)
                      async function updateData() {
                        feeFlag = window.feeFlag
                        if (feeFlag==='True'){
                          series.hide(1000).then(function(ev) {
                            console.log("Series finished hiding");
                            data = window.feeData
                            console.log('feeData' , feeData)
                            series.data.setAll(data);
                            series.appear(1000, 100);
                            window.feeFlag = 'False'
                          })
                        }
                      }
                  }); 
                  //---------------------------------------------------------------------------------
                am5.ready(function() {
                    var root = am5.Root.new("mnsChart");
                    root.setThemes([
                      am5themes_Animated.new(root)
                    ]);
                    var series = root.container.children.push(am5flow.ChordDirected.new(root, {
                      startAngle: 185,
                      padAngle: 1,
                      linkHeadRadius: undefined,
                      sourceIdField: "from",
                      targetIdField: "to",
                      valueField: "value"
                    }));
                    series.nodes.labels.template.setAll({
                      textType: "radial",
                      centerX: 0,
                      fontSize: 10
                    });
                    series.links.template.set("fillStyle", "source");
                    setInterval(function() {
                       updateData();
                      }, 2000)
                      async function updateData() {
                        mnsFlag = window.mnsFlag
                        if (mnsFlag==='True'){
                          series.hide(1000).then(function(ev) {
                            console.log("Series finished hiding");
                            data = window.mnsData
                            series.data.setAll(data);
                            series.appear(1000, 100);
                            window.mnsFlag = 'False'
                          })
                        }
                      } 
                  }); 
                  //---------------------------------------------------------------------------------
                am5.ready(function() {
                    var root = am5.Root.new("posChart");
                    root.setThemes([
                      am5themes_Animated.new(root)
                    ]);
                    var series = root.container.children.push(am5flow.ChordDirected.new(root, {
                      startAngle: 180,
                      padAngle: 1.2,
                      linkHeadRadius: undefined,
                      sourceIdField: "from",
                      targetIdField: "to",
                      valueField: "value"
                    }));
                    series.nodes.labels.template.setAll({
                      textType: "radial",
                      centerX: 0,
                      fontSize: 11
                    });
                    series.links.template.set("fillStyle", "source");
                    setInterval(function() {
                       updateData();
                      }, 2000)
                      async function updateData() {
                        posFlag = window.posFlag
                        if (posFlag==='True'){
                          series.hide(1000).then(function(ev) {
                            console.log("Series finished hiding");
                            data = window.posData
                            series.data.setAll(data);
                            series.appear(1000, 100);
                            window.posFlag = 'False'
                          })
                        }
                      }
                  }); 
                  //---------------------------------------------------------------------------------------
                  
              }



    <!-- /.row -->
    <!-- /#page-wrapper -->
    <!-- /#wrapper -->
    <!-- JavaScript -->
    <script src="js/jquery-1.10.2.js"></script>
    <script src="js/bootstrap.js"></script>
    <!-- Page Specific Plugins -->
    <script src="//cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script>
    <script src="http://cdn.oesmith.co.uk/morris-0.4.3.min.js"></script>
    <script src="js/morris/chart-data-morris.js"></script>
    <script src="js/tablesorter/jquery.tablesorter.js"></script>
    <script src="js/tablesorter/tables.js"></script>
  </body>
</html>
